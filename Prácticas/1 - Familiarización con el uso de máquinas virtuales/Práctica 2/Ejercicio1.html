<!DOCTYPE html>
<html>
<head>







  
  
  
  
  
  
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">






  
  
  
  
  
  
  <title>Ejercicio 1 - Uso de instant&aacute;neas durante la configuraci&oacute;n de un Windows XP</title>
</head>


<body>







<h1 style="text-align: center;"> <b style=""><span style="font-size: 18pt;"></span></b></h1>







<table style="width: 1098px; height: 155px;" border="0">







  <tbody>







    <tr>







      



      <td style="width: 21.25px;"><img style="width: 99px; height: 93px;" alt="" src="img/uma.png"><br>







      </td>







      <td style="width: 1164.97px;">
      
      
      
      
      
      
      <h1 style="text-align: center;"><b style=""><span style="font-size: 18pt;">Ejercicio 1 &nbsp;- Uso de
instant&aacute;neas durante la configuraci&oacute;n de un
Windows XP<br>







      </span></b></h1>







      </td>







      <td style="width: 21.25px;"> <img style="width: 99px; height: 93px;" title="dac" src="img/dac.png"> </td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







En este ejercicio vamos a partir de la m&aacute;quina virtual
Windows XP SP2 que hemos instalado en un ejercicio anterior. Queremos
configurarla de tal forma que nos quede una m&aacute;quina que
requiera un uso m&iacute;nimo de memoria RAM y de espacio de disco
duro real, pues as&iacute; podemos usarla como base "limpia" sobre
la que posteriormente instalar software adicional. Por ello, usaremos
instant&aacute;neas para ir probando distintas configuraciones, y
quedarnos con la m&aacute;s ventajosa. <br>







<br>







Para realizar el ejercicio, seguiremos estos&nbsp;pasos:<br>







<br>







<span style="font-weight: bold;">1)</span>
&nbsp;En el <a href="../Practica1/Ejercicio1.html">Ejercicio
1 de la Pr&aacute;ctica 1</a> hemos creado la
m&aacute;quina virtual WinXP, en el directorio&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>. Abrir
esta m&aacute;quina en el VMware Workstation del Windows 7, pero NO
arrancarla todav&iacute;a.<br>







<br>







Para poder experimentar con tranquilidad diversas opciones de
configuraci&oacute;n, vamos a congelar con una
instant&aacute;nea el estado inicial de esta m&aacute;quina,
para poder volver a &eacute;l, deshaciendo todos los cambios,
cuando sea necesario.<br>







<br>







<span style="font-weight: bold;">2)</span> Abrir el
gestor de las instant&aacute;neas de esta m&aacute;quina
virtual, usando el men&uacute; <span style="font-weight: bold;">VM
-&gt; Snapshot -&gt; Snapshot Manager</span>.<br>







<br>







<div style="text-align: left;"><img style="width: 421px; height: 265px;" alt="" src="img/abrir_manager.png"><br>







</div>







<br>







<span style="font-weight: bold;">3)</span> Crear una
instant&aacute;nea pulsando el bot&oacute;n <span style="font-weight: bold;">Take Snapshot</span>. Darle
el nombre <span style="font-weight: bold;">Inicial</span>,
y pulsar <span style="font-weight: bold;">Take Snapshot</span>.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="width: 284px; height: 159px;" alt="" src="img/take_snapshot.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="width: 357px; height: 219px;" alt="" src="img/name_snapshot.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







Tras tomar la instant&aacute;nea podemos ver, en el interfaz
gr&aacute;fico del gestor de instant&aacute;neas, una
representaci&oacute;n gr&aacute;fica de las
instant&aacute;neas existentes entre la creaci&oacute;n de la
m&aacute;quina virtual y su estado actual. Documentando
adecuadamente cada instant&aacute;nea (mediante su nombre y su
campo <span style="font-style: italic;">Description</span>),
esta representaci&oacute;n es muy &uacute;til para hacer el
seguimiento a la evoluci&oacute;n de una m&aacute;quina virtual
de pruebas, y as&iacute; poder ubicar f&aacute;cilmente la
instant&aacute;nea que contiene cada cambio concreto.<br>







<br>







<img style="width: 201px; height: 88px;" alt="" src="img/ramal_instantaneas.png"><br>







<br>







<span style="font-weight: bold;">4)</span> Si
abrimos la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>
podemos ver que el a&ntilde;adir una instant&aacute;nea a la
m&aacute;quina virtual ha hecho aparecer dos nuevos ficheros:<br>







<br>







<ul>







  <li><span style="font-style: italic;">WinXP-Snapshot1.vmsn</span>,
que es la descripci&oacute;n del estado de la m&aacute;quina
virtual en el momento de tomar la instant&aacute;nea.<br>







    <br>







  </li>







  <li><span style="font-style: italic;">WinXP-00001.vmdk</span>,
que es el fichero de disco virtual en el que el hipervisor va anotando
incrementalmente los cambios que se han producido con respecto al
estado del disco virtual <span style="font-style: italic;">WinXP.vmdk</span>,
que queda congelado.</li>







</ul>







Primero, vamos a realizar en la m&aacute;quina virtual algunos
cambios importantes (y para nada inteligentes) que luego tendremos que
revertir; &eacute;sto nos permitir&aacute; comprobar
c&oacute;mo con la instant&aacute;nea podremos deshacer estos
cambios sin dejar secuelas en la m&aacute;quina virtual.<br>




<br>







<span style="font-weight: bold;">5)</span> Cerramos
la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>,
volvermos al VMware Workstation, y editamos los Settings de la
m&aacute;quina virtual para, en la pesta&ntilde;a <span style="font-weight: bold;">Hardware</span>, eliminar
la unidad lectora de CD/DVD; para ello la
seleccionamos,&nbsp;pulsamos el bot&oacute;n <span style="font-weight: bold;">Remove</span>, y luego <span style="font-weight: bold;">OK</span>.<br>







<br>







<div style="text-align: center;"><img style="width: 667px; height: 569px;" alt="" src="img/remove_cd.png"><br>







</div>







<br>







<span style="font-weight: bold;">6)</span>
Arrancamos la m&aacute;quina virtual con <span style="font-weight: bold;">Power On</span>. Ignorar
cualquier aviso inicial del XP; cerrar sus globos informativos pulsando
en la "x", como muestra la figura.<br>







<br>







<img style="width: 292px; height: 118px;" alt="" src="img/cierra_globo.png"><br>







<br>







<span style="font-weight: bold;">7)</span> En el
men&uacute; <span style="font-weight: bold;">Inicio</span>,
abrir <span style="font-weight: bold;">Mi PC</span>.
Podemos comprobar ah&iacute; que, efectivamente, ha desaparecido la
unidad de CD-ROM.<br>







<br>







Vamos a hacer ahora un par de cambios cosm&eacute;ticos, de efecto
muy visible, de forma que podamos notar inmediatamente, al recuperar el
estado de la instant&aacute;nea, que estos cambios se han revertido.<br>







<br>







<span style="font-weight: bold;">9)</span> Con el
bot&oacute;n derecho pulsar sobre el fondo del escritorio y abrir
su
men&uacute; de propiedades de pantalla. En la pesta&ntilde;a <span style="font-weight: bold;">Escritorio</span> elegir <span style="font-weight: bold;">Desierto rojo con luna</span>,
y pulsar <span style="font-weight: bold;">Aplicar</span>.<br>







<br>







<img style="width: 395px; height: 447px;" alt="" src="img/desierto_rojo.png"><br>







<br>







<span style="font-weight: bold;">10)</span> En la
pesta&ntilde;a <span style="font-weight: bold;">Configuraci&oacute;n</span>,
seleccionar <span style="font-weight: bold;">1024 x 768</span>
como resoluci&oacute;n de pantalla. Pulsar <span style="font-weight: bold;">Aplicar</span>, y conservar
los cambios.<br>







<br>







<span style="font-weight: bold;">11)</span>
Finalmente, en la pesta&ntilde;a <span style="font-weight: bold;">Protector de pantalla</span>,
configurar la espera a tan s&oacute;lo 1 minuto de inactividad.
Pulsar <span style="font-weight: bold;">Aceptar</span>.<br>







<br>







<img style="width: 147px; height: 30px;" alt="" src="img/1minuto.png"><br>







<br>







Ahora provocaremos tambi&eacute;n en el contenido del disco duro
cambios f&aacute;ciles de notar, desinstalando del Windows los
juegos, y copiando al escritorio desde el Windows 7 un fichero de
tama&ntilde;o apreciable.<br>







<br>







<span style="font-weight: bold;">12)</span>
Comprobamos que los juegos est&aacute;n instalados, usando el
men&uacute; <span style="font-weight: bold;">Inicio
-&gt; Todos los programas -&gt; Juegos -&gt; Buscaminas</span>
para abrir el juego del buscaminas, y lo cerramos inmediatamente
despu&eacute;s.<br>







<br>







<span style="font-weight: bold;">13)</span> Usamos
ahora <span style="font-weight: bold;">Inicio -&gt;
Panel de control -&gt; Agregar o quitar programas</span> para
abrir la herramienta de gesti&oacute;n del software instalado.
Haciendo click sobre <span style="font-weight: bold;">Agregar
o quitar componentes de Windows</span> abrimos la ventana que
permite elegir componentes de sistema a desinstalar.<br>







<br>







<img style="width: 101px; height: 97px;" alt="" src="img/agregar_componentes.png"><br>







<br>







<span style="font-weight: bold;">14)</span>
Seleccionando <span style="font-weight: bold;">Accesorios
y utilidades</span> pulsamos el bot&oacute;n <span style="font-weight: bold;">Detalles</span>. Quitamos
la marca del subcomponente <span style="font-weight: bold;">Juegos</span>,
y pulsamos <span style="font-weight: bold;">Aceptar</span>.
Pulsamos <span style="font-weight: bold;">Siguiente</span>
para que se ejecute la desinstalaci&oacute;n, y cerramos la ventana.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 508px; height: 476px;" alt="" src="img/detalles.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 432px; height: 66px;" alt="" src="img/juegos.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







<span style="font-weight: bold;">15)</span> Usando
de nuevo <span style="font-weight: bold;">Inicio
-&gt; Todos los programas -&gt; Juegos</span>,
comprobamos que esta carpeta est&aacute; ahora vac&iacute;a.<br>







<br>







<span style="font-weight: bold;">16)</span> Ahora,
en el Windows 7, abrimos la carpeta <span style="font-style: italic;">Debian5minimo</span>, y
arrastramos el fichero <span style="font-style: italic;">Debian5minimo.vmdk</span>
al escritorio del Windows XP en la m&aacute;quina virtual. Como ese
fichero contiene el disco duro virtual completo de esa
instalaci&oacute;n Debian, conseguimos as&iacute;&nbsp;crear r&aacute;pidamente en nuestra m&aacute;quina virtual
Windows XP un fichero que ha a&ntilde;adido 725 MB al contenido del
disco virtual del XP ya con la instant&aacute;nea creada (y que,
por tanto, se habr&aacute;n a&ntilde;adido no al fichero
correspondiente al estado congelado del disco, sino al correspondiente
a las modificaciones a partir de dicho estado).<br>







<br>







<span style="font-weight: bold;">17)</span> Para
comprobarlo, abrimos en el Windows 7 la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>,
pulsamos F5 para refrescar los tama&ntilde;os de los ficheros, y
comprobamos que el fichero <span style="font-style: italic;">WinXP-00001.vmdk</span>(que
contiene los cambios en el disco duro desde que se cre&oacute;
la instant&aacute;nea) ha crecido a m&aacute;s de 800 MB de
tama&ntilde;o (NOTA: en la versi&oacute;n 10 del VMware Workstation
este tama&ntilde;o se ha duplicado hasta los 1,5 GB. Intente razonar
porqu&eacute;).<br>







<br>







<img style="width: 581px; height: 47px;" alt="" src="img/crecimiento_instantanea.png"><br>







<br>







Vamos ahora a revertir todos los cambios realizados, simplemente
devolviendo el estado de la m&aacute;quina virtual al que
ten&iacute;a en el momento de sacar la instant&aacute;nea.<br>







<br>







<span style="font-weight: bold;">18)</span> Apagamos
de la forma normal la m&aacute;quina virtual, v&iacute;a el
men&uacute; <span style="font-weight: bold;">Inicio
-&gt; Apagar</span>.<br>







<br>







<span style="font-weight: bold;">19)</span> Usando
el men&uacute; <span style="font-weight: bold;">VM
-&gt; Snapshot -&gt; Snapshot Manager</span>, abrimos el
gestor de instant&aacute;neas. Seleccionar la
instant&aacute;nea <span style="font-weight: bold;">Inicial</span>,
y pulsar el bot&oacute;n <span style="font-weight: bold;">Go
To</span> para restaurar la m&aacute;quina virtual al estado
correspondiente a esa instant&aacute;nea. Aparecer&aacute; una
ventana pidiendo confirmaci&oacute;n de que queremos volver al
estado <span style="font-style: italic;">Inicial</span>.
Contestar <span style="font-weight: bold;">Yes</span>.<br>







<br>







<img style="width: 197px; height: 93px;" alt="" src="img/estado_inicial.png"><br>







<br>







(NOTA: un m&eacute;todo alternativo, y m&aacute;s
r&aacute;pido, para volver al estado de la instant&aacute;nea <span style="font-style: italic;">Inicial</span> es usar el
men&uacute; <span style="font-weight: bold;">VM
-&gt; Snapshot -&gt; 1 Inicial</span> )<br>







<br>







<span style="font-weight: bold;">20)</span> Para
comprobar que la m&aacute;quina virtual ha vuelto a su estado
original, comenzamos editando los Settings de la m&aacute;quina. En
la pesta&ntilde;a <span style="font-weight: bold;">Hardware</span>
veremos que vuelve a existir una unidad de CD/DVD.<br>







<br>







<span style="font-weight: bold;">21)</span> Cerramos
la ventana de Settings, y en el Windows 7 abrimos la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>. En
ella podremos ver que ahora el fichero con los cambios incrementales en
el disco duro desde el momento de tomar la instant&aacute;nea se
llama <span style="font-style: italic;">WinXP-000002.vmdk</span>,
y ha vuelto a su tama&ntilde;o original de 5 MB. (El cambio de
nombre se debe a que el VMware Workstation guarda, en el fichero <span style="font-style: italic;">.vmsd</span>, un
n&uacute;mero de versionado de ficheros de instant&aacute;nea,
de forma que, aunque la instant&aacute;nea sea la misma, utiliza un
fichero de nombre distinto para evitar colisiones).<br>







<br>







<span style="font-weight: bold;">22)</span> Cerramos
la carpeta, y arrancamos la m&aacute;quina virtual. Veremos que la
pantalla ha vuelto a la resoluci&oacute;n de 640 x 480, que el
fondo del escritorio vuelve a ser el&nbsp;t&iacute;pico prado
que aparece por defecto tras la instalaci&oacute;n de un Windows
XP, y que el salvapantallas ya no se est&aacute; disparando tras
s&oacute;lo un minuto de inactividad.<br>







<br>







<span style="font-weight: bold;">23)</span>
Comprobamos tambi&eacute;n que ha desaparecido del escritorio de la
m&aacute;quina virtual el fichero <span style="font-style: italic;">.vmdk</span> que
hab&iacute;amos copiado, y , si ejecutamos <span style="font-weight: bold;">Inicio -&gt; Todos los
programas -&gt; Juegos -&gt; Buscaminas</span>, vemos que
los juegos vuelven a formar parte de la instalaci&oacute;n.<br>







<br>







Para su uso en producci&oacute;n es conveniente que las
m&aacute;quinas virtuales sean tan econ&oacute;micas en consumo
de memoria y disco duro como sea posible. Aprovechando que tenemos una
instant&aacute;nea con un estado inicial al que revertir si hacemos
algo mal, vamos a intentar configurar este Windows XP para reducir su
consumo de memoria, disco, y CPU.<br>







<br>







<span style="font-weight: bold;">24)</span> Primero
vamos a ver cu&aacute;ntos recursos est&aacute; consumiendo el
sistema en su estado inicial. Para ello, abrimos el Administrador de
tareas y, en la pesta&ntilde;a de <span style="font-weight: bold;">Rendimiento</span>,
comprobamos cual es el uso de memoria y el n&uacute;mero de
procesos (en la figura, respectivamente, 106 MB y 24 procesos).<br>







<br>







<img style="width: 397px; height: 447px;" alt="" src="img/consumo_inicial.png"><br>







<br>







<span style="font-weight: bold;">25)</span>
&nbsp;Vamos a hacer m&aacute;s c&oacute;modo el trabajo,
usando una pantalla m&aacute;s grande. Para ello, pulsando con el
bot&oacute;n derecho sobre el escritorio, abrimos las propiedades
de gr&aacute;ficos y, en la pesta&ntilde;a <span style="font-weight: bold;">Configuraci&oacute;n</span>,
cambiamos la resoluci&oacute;n a 1024 x 768. Tras ello, volvemos a
abrir el Administrador de tareas y, en la pesta&ntilde;a <span style="font-weight: bold;">Rendimiento</span>
comprobamos que el consumo de memoria sigue alrededor de los 107 MB.<br>







<br>







<span style="font-weight: bold;">26)</span> Ahora
abrir de nuevo las propiedades de gr&aacute;ficos del escritorio.
En la pesta&ntilde;a <span style="font-weight: bold;">Temas</span>
seleccionar <span style="font-weight: bold;">Cl&aacute;sico
de Windows</span>, y pulsar <span style="font-weight: bold;">Aplicar</span>.
Despu&eacute;s, en <span style="font-weight: bold;">Inicio
-&gt; Panel de Control -&gt; Apariencia y Temas</span>
elegir <span style="font-weight: bold;">Barra de Tareas y
Men&uacute; Inicio</span>. En la pesta&ntilde;a <span style="font-weight: bold;">Men&uacute; Inicio</span>
seleccionar <span style="font-weight: bold;">Men&uacute;
Inicio Cl&aacute;sico</span>, y pulsar <span style="font-weight: bold;">Aceptar</span>. Cerrar la
ventana del Panel de Control.<br>







<br>







<img style="width: 397px; height: 442px;" alt="" src="img/menu_clasico.png"><br>







<br>







<span style="font-weight: bold;">27)</span> Abrir de
nuevo las propiedades gr&aacute;ficas del Escritorio y, en la
pesta&ntilde;a <span style="font-weight: bold;">Escritorio</span>,
pulsar <span style="font-weight: bold;">Personalizar
Escritorio...</span> &nbsp;Dejar marcada
&uacute;nicamente la opci&oacute;n <span style="font-weight: bold;">Mi PC</span>, y pulsar <span style="font-weight: bold;">Aceptar</span> hasta cerrar
las propiedades de gr&aacute;ficos.<br>







<br>







<img style="width: 400px; height: 477px;" alt="" src="img/personalizar_escritorio.png"><br>







<br>







<span style="font-weight: bold;">28)</span> Ahora
pulsar con el bot&oacute;n derecho sobre el &iacute;cono de <span style="font-weight: bold;">Mi PC</span>, abrir sus
Propiedades, y en la pesta&ntilde;a <span style="font-weight: bold;">Opciones avanzadas</span>
pulsar en el bot&oacute;n de <span style="font-weight: bold;">Configuraci&oacute;n
de Rendimiento</span>. En la pesta&ntilde;a <span style="font-weight: bold;">Efectos visuales</span>,
seleccionar la opci&oacute;n <span style="font-weight: bold;">Ajustar
para obtener el mejor rendimiento</span> y pulsar <span style="font-weight: bold;">Aceptar</span> hasta cerrar
las ventanas.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 416px; height: 250px;" alt="" src="img/config_rendimiento.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 373px; height: 173px;" alt="" src="img/opciones_rendimiento.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







<span style="font-weight: bold;">29)</span> Abrir <span style="font-weight: bold;">Inicio -&gt;
Configuraci&oacute;n -&gt; Panel de Control</span>. Abrir
<span style="font-weight: bold;">Actualizaciones
Autom&aacute;ticas</span>, y desactivarlas.<br>







<br>







<img style="width: 418px; height: 470px;" alt="" src="img/desactivar_actualizaciones.png"><br>







<br>







<span style="font-weight: bold;">30)</span> Abrir
ahora <span style="font-weight: bold;">Centro de Seguridad</span>,
y pulsar <span style="font-weight: bold;">Cambiar la
forma en que el Centro de Seguridad me alerta</span>. Desactivar
todas las alertas, y pulsar <span style="font-weight: bold;">Aceptar</span>.
Cerrar el Centro de Seguridad y el Panel de Control.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 209px; height: 326px;" alt="" src="img/centro_seguridad.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 403px; height: 309px;" alt="" src="img/alertas.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







<span style="font-weight: bold;">31)</span> Si
volvemos a abrir ahora el Administrador de tareas veremos en la
pesta&ntilde;a <span style="font-weight: bold;">Rendimiento</span>
que el n&uacute;mero de procesos se ha reducido a 22, y el uso de
memoria a 97-98 MB (fundamentalmente por los dos procesos que se han
eliminado al quitar las actualizaciones y los avisos).<br>







<br>







<img style="width: 199px; height: 282px;" alt="" src="img/reduccion_memoria.png"><br>







<br>







<span style="font-weight: bold;">32)</span> Ahora
vamos a minimizar el consumo de disco. Primero, reiniciamos la
m&aacute;quina virtual; una vez terminado el arranque, comprobamos
en el Windows 7 (usando el bot&oacute;n derecho para invocar <span style="font-weight: bold;">Propiedades</span>) que la
carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span>
ocupa, antes de comenzar la reducci&oacute;n, un tama&ntilde;o
de unos&nbsp;2,10 GB en disco.<br>







<br>







<img style="width: 364px; height: 246px;" alt="" src="img/tamano_inicial.png"><br>







<br>







<span style="font-weight: bold;">33)</span> En el
Windows XP abrimos <span style="font-weight: bold;">Mi PC</span>
y, con el bot&oacute;n derecho, abrimos las propiedades de la
unidad de disco C. Pulsamos <span style="font-weight: bold;">Liberar
espacio en disco</span>. Comprobamos que, en este caso (al ser
una m&aacute;quina reci&eacute;n instalada) no hay
todav&iacute;a archivos temporales que borrar, por lo que pulsamos <span style="font-weight: bold;">Cancelar</span>.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 436px; height: 186px;" alt="" src="img/liberar_espacio.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 360px; height: 165px;" alt="" src="img/no_temporales.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







(NOTA: En una m&aacute;quina virtual en la que s&iacute; se
haya instalado software, adem&aacute;s del de sistema operativo,
estos ficheros temporales s&iacute; suponen una apreciable cantidad
de espacio de disco recuperable, y siempre merece la pena eliminarlos
si se quiere reducir al m&iacute;nimo el tama&ntilde;o de la
m&aacute;quina virtual).<br>







<br>







<span style="font-weight: bold;">34)</span> Ahora,
en la pesta&ntilde;a <span style="font-weight: bold;">Herramientas</span>,
pulsar <span style="font-weight: bold;">Desfragmentar
ahora</span>. Pulsar directamente el bot&oacute;n <span style="font-weight: bold;">Desfragmentar</span>, y
esperar a que termine el proceso.<br>







<br>







<img style="width: 333px; height: 211px;" alt="" src="img/desfragmentar.png"><br>







<br>







(NOTA: La desfragmentaci&oacute;n no reduce el espacio usado en
disco, pero hace que el fichero con que el hipervisor implementa el
disco virtual din&aacute;mico - "thin" - sea m&aacute;s
eficiente, al poner contiguos todos los bloques ocupados por los
ficheros, y separarlos de los bloques que han quedado libres).<br>

<br>

(NOTA2: La desfragmentaci&oacute;n se puede hacer aun cuando haya instantaneas
creadas. Sin embargo, si el prop&oacute;sito final es crear una m&aacute;quina
virtual lo m&aacute;s compacta posible, lo m&aacute;s eficiente ser&aacute; primero eliminar
las instantaneas - aceptando como definitiva, por tanto,&nbsp;la
configuraci&oacute;n actual -y despu&eacute;s desfragmentar).<br>







<br>







(<span style="font-weight: bold;">MUY IMPORTANTE</span>: <span style="text-decoration: underline; font-weight: bold;">NUNCA
DESFRAGMENTAR UN DISCO SSD</span>. Incluso en un disco thin de
m&aacute;quinas virtuales la ganancia de eficiencia es
m&iacute;nima o nula, y las m&uacute;ltiples escrituras de la
desfragmentaci&oacute;n acortar&aacute;n
dr&aacute;sticamente la vida del disco).<br>

<br>

<span style="font-weight: bold;">35)</span> Como la
configuraci&oacute;n de la m&aacute;quina virtual es ya
adecuada como base de trabajo, vamos a consolidarla eliminando la
instant&aacute;nea. Para ello, primero apagamos la
m&aacute;quina virtual.<br>







<br>







<span style="font-weight: bold;">36)</span> Una vez
apagada, abrimos el gestor de instant&aacute;neas con <span style="font-weight: bold;">VM -&gt; Snapshot -&gt;
Snapshot Manager</span>, seleccionamos la instant&aacute;nea <span style="font-weight: bold;">Inicial</span> y pulsamos <span style="font-weight: bold;">Delete</span>. Contestamos
que <span style="font-weight: bold;">Yes</span> a
la petici&oacute;n de confirmaci&oacute;n y, una vez finalizado
el proceso, vemos que la instant&aacute;nea <span style="font-style: italic;">Inicial</span> ha
desparecido de la ruta de evoluci&oacute;n de la m&aacute;quina
virtual.<br>







<br>







<br>







<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">







  <tbody>







    <tr>







      <td style="text-align: center; vertical-align: middle;"><img style="width: 623px; height: 503px;" alt="" src="img/delete_snapshot.png"></td>







      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 215px; height: 134px;" alt="" src="img/no_instantanea.png"></td>







    </tr>







  
  
  
  
  
  
  </tbody>
</table>







<br>







<br>







<span style="font-weight: bold;">37)</span> Cerramos
el gestor de instant&aacute;neas y comprobamos en la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span> que
ahora s&oacute;lo hay un &uacute;nico fichero de disco duro, <span style="font-style: italic;">WinXP.vmdk</span>, que
pesa 1,68 GB.<br>

<br>







<span style="font-weight: bold;">38)</span> Antes de reducir el disco
vamos a configurar las&nbsp;VMware Tools para que mantengan la
sincronizaci&oacute;n horaria entre host y guest, es decir, que la
m&aacute;quina virtual sincronice su reloj
con el del anfitri&oacute;n. (NOTA: esto no se necesita para
reducir el tama&ntilde;o ocupado en disco, pero casi siempre es
&uacute;til tenerlo activado, as&iacute; que aprovechamos y lo
hacemos ahora). Lo haremos a trav&eacute;s del men&uacute; <span style="font-weight: bold;">VM -&gt; Settings</span>, en la pesta&ntilde;a <span style="font-weight: bold;">Options</span>, entrada <span style="font-weight: bold;">VMware Tools</span>; marcar la opci&oacute;n <span style="font-weight: bold;">Synchronize guest time with host</span>.<br>







<br>







<img style="border: 1px solid ; width: 691px; height: 367px;" alt="" src="img/sincro_horaria.png"><br>







<br>







<span style="font-weight: bold;"></span><br>







Ahora vamos a preparar el disco para reducirlo. Cuando un fichero es
borrado del disco virtual, los sectores de disco que ocupaba quedan
libres a nivel de sistema operativo, pero a nivel del propio disco el
bloque sigue ocupado por datos (aun cuando ahora sean ya irrelevantes),
y por tanto esos bloques deben seguir conserv&aacute;ndose en el
fichero que implementa el disco duro virtual "thin".<br>







<br>







La&nbsp;<span style="font-style: italic;">preparaci&oacute;n
para reducir</span> recorre todos los sectores del disco virtual
y marca (poni&eacute;ndolos a 0) los sectores que han quedado
libres debido a borrado de ficheros. La reducci&oacute;n, a
continuaci&oacute;n, elimina esos bloques del disco duro virtual, y
compacta los huecos, de forma que el fichero de disco virtual contenga
exclusivamente sectores con contenidos "vivos".<br>

<br>

En versiones anteriores de VMware workstation este proceso deb&iacute;a
realizarse en dos pasos, a trav&eacute;s de las VMware Tools: primero,
preparar para reducir el disco (b&aacute;sicamente, poner a 0 los
sectores a eliminar), y luego proceder a la eliminaci&oacute;n en
s&iacute;. En la versi&oacute;n 10 del VMware Workstation ya no es
necesario este procedimiento, porque las propias Tools gestionan,
coordinadamente con el driver Windows de NTFS, el estado de borrado de
los diversos sectores, de tal forma que la reducci&oacute;n del disco
se puede hacer ahora desde el propio hipervisor, y con la
m&aacute;quina virtual apagada.<br>






<br>






<span style="font-weight: bold;">39)</span> Abrir el men&uacute; <span style="font-weight: bold;">VM -&gt; Manage -&gt; Clean Up Disks</span>.
El hipervisor analiza el estado del disco de la m&aacute;quina virtual,
y nos informa de qu&eacute; espacio de disco f&iacute;sico real puede
ser recuperado. Pulsar <span style="font-weight: bold;">Clean up now</span>.<br>

<br>

<img style="border: 1px solid ; width: 395px; height: 189px;" alt="" src="img/disk_cleanup.png"><br>






<br>






<span style="font-weight: bold;">40)</span> Cerrar el VMware Workstaton. En la carpeta&nbsp;<span style="font-style: italic;">D:\practicas\MV</span><span style="font-style: italic;">\WinXP</span> comprobar ahora el tama&ntilde;o resultante del fichero <span style="font-style: italic;">.vmdk</span>; veremos que se ha reducido a tan s&oacute;lo 1,34 GB.<br>






<br>






<span style="font-weight: bold;">42)</span> Vamos a dejar la carpeta
reducida al m&iacute;nimo n&uacute;mero de ficheros necesarios para,
por ejemplo, copiar la m&aacute;quina virtual. Para ello, borrar todos
los ficheros y carpetas, <span style="text-decoration: underline;">EXCEPTO</span> los ficheros <span style="font-style: italic;">WinXP.vmx</span>&nbsp; y&nbsp;<span style="font-style: italic;">WinXP.vmdk</span>. Como resultado, la carpeta <span style="font-style: italic;">WinXP</span>
contiene una m&aacute;quina XP lista para usar como base para instalar
software, que pesa s&oacute;lamente 1,34 GB, y compuesta s&oacute;lo
por dos ficheros.<br>






<br>






<span style="font-weight: bold;">43)</span> Si ahora comprimimos la carpeta <span style="font-style: italic;">WinXP</span> nos queda un fichero zip de tan s&oacute;lo 722 MB, que puede llevarse con comodidad en un stick de memoria.<br>






<br>





<a href="Ejercicio2.html">
Continuar al Ejercicio 2</a><br>







<br>







</body>
</html>
